
Script documentation for file: summary_week_10_9_20, Updated on:2020-10-09 19:02:00.257970
==========================================================================================

# Work summary for week of of 10/9/20


In the past two weeks, my thinking about the best way to understand the social behavior project has changed significantly. I have a new set of directions in mind through fourier descriptors* that I think will significantly open up our ability to study natural behaviors. I came upon this new set of directions in the context of denoising, so I will start by explaining how this came to be.  
You will recall that this was my todo list the last time that I showed it to you:
- [ ] Polar Data Representation
    - [x] Render all existing data in 2-level polar representation [(here)](./polar_representation.md)
    - [ ] Test 3-level representation with per-mouse average level included
    - [ ] Build in mouse-specific data into representation with marked training points
        - [x] Extract out training points (`social_pursuit.data.labeled.LabeledData.dataarray`)
        - [x] Extract out image contours from training frames [(here)](./get_statistical_shape_model.md)
        - [x] Calculate fourier descriptors on the image (`social_pursuit.data.labeled.LabeledData.get_contour_fourier_rep`) and turn into statistical shape model (mean and variance in fourier space) [(here)](./from_contours_to_shape_model.md)
        - [ ] Create joint gaussian model of fourier descriptors* with the marker locations, and condition one on the other
        - [ ] Build an edge cost to directly fit fourier descriptors* from the image by matching to detected edges in the image. This can give us a conditional model of the best image contour given the image and marked poses.
    - [ ] Determine robustness vs. existing methods for pursuit detection
- [ ] Denoising Revisited
    - [x] Write algorithm to classfiy trajectories as clean/problematic based on 1) existence of switches, and 2) entire loss of other animal with clustering algorithms on relative bodypart angle.[ (see here)](./polar_classification.md)
    - [ ] Segment with clustering algorithms on the angles of body parts
        - [x] Build mechanism to generate noisy surrogate data for testing [(here)](./polar_classification_validation.md)
        - [ ] Test performance against surrogate data
        - [ ] Include routine to reference image when points are unreliable
    - [ ] Compare to segmentation generated by current heuristic measures.Try Branch and Bound with Wavelet Transform/ WTMM. (This is a good cost because linear interpolation will be interpreted as a singularity too).
    - [ ] Compare to current segment assignment formalism
- [ ] Pursuit Characterization
    - [ ] Characterize stereotypy in groundtruth pursuits with polar representation
        - [ ] Cluster average position signal (l1, theta1)
        - [ ] Cluster relative position signal (l2, theta2)
    - [ ] Detect stereotypical pre-pursuit events: 'turning' about the mean position.Look for interesting stereotypy characteristics across non-pursuit portions of the trajectory.


*Why should we care so much about image contours? Why invest so much energy in a preprocessing step for denoising?  
I think that using fourier descriptors for animal contours can be much more than preprocessing for denoising, and it is in fact a natural extension of the work we are already doing that open the door to a lot of new analyses if we take it as a more central idea than markers. As I see it: 
- Our analysis thus far is a special case of fourier descriptor analysis, where we have just looked at the DC component to localize the centroid of the animal.
- We automatically include orientation information, which keeps coming up as a salient modeling feature, as well as a lot more.
- We can increase the reliability of all detections by establishing a link to the image. It doesn't make sense to ignore all the information there, until we really want to invest in a fast online method. This can come later though if it really is necessary.
- Animal contours are actually more interesting than individual points for our application. We can say interesting things about contact, deformation, and have more info to build a 'social physics' if we should want to go in that direction. We also know that contours + depth information give interesting phenomena through examples like moseq, behavenet if we want to go in that direction again.

## Post-Meeting Updates

### Relevant Literature for Fourier Descriptors and Movement Analysis


The 90s literature on applying fourier descriptors puts a lot of weight on the problem of finding and characterizing deformable objects in biomedical imaging data. Kashi et al. 1996 use Fourier descriptors (and wavelet descriptors) to the analysis of corpus callosum shapes between left and right handed inviduals. They describe the utility of these representations to creating average shapes. Staib and Duncan 1992 use Fourier Descriptors to look for objects of a certain shape in an image. They develop intuition for fourier descriptors as ellipses, and a correspondingly intuitive parametrization, then fit boundary templates to brain scan images using a gaussian model and MAP inference. Neumann and Lorenz 1998 consider the eigenspace of fourier description features, creating low dimensional representations of shape from a training set of biomedical images. They then use these representations along with gradient information from the image to fit objects in other images through an iterative, interactive process: First, the algorithm automatically selects a representation in PCA space that fits well to edged detected in the image. Then, the user indicates points that should be included on the boundary described by fourier features, leading to refinement.

In addition to finding and characterizing static objects, fourier descriptors have also been used to characterize movement sequences in humans and other organisms. Ling et al. 2007 compute sequences of fourier descriptors on human silhouettes to classify actions, either through hausdorff metric based methods or by fitting an HMM to the top frequency components of the fourier descriptor signal. Wang et al. 2008 attempt to learn subspaces of shape features using Kernel Locality Preserving Projections (KLPP) with a gaussian kernel to classify silhouette sequences. Finally, Dugamarti et al. 2019 applied Fourier Descriptor methods to the analysis of soft robots (tentacles, robots with inflatable cavities, etc), and showed the ability of PCA based methods to distinguish periodicity in complex deformation, as well as the quantitative comparison of dynamic shape trajectories by projecting the PCA weights from one shape sequence into the eigenspace of another.
### What is the sunk cost?


To what degree is this a departure from the work that we have already done? We can address this question in two ways: 1) in terms of the scientific insight we have gained, and 2) in terms of the methodological advances we have made. In terms of scientific insight, I can see very little sunk cost. All of our analysis thus far has focused on analysis of animal centroids, including everything from my characterization of virgin pursuit/aggression to Luhuan's modeling work. We can very reasonably consider our analysis to this point as an analysi of the DC component of both trajectories, and consider what comes next as a natural next step. Furthermore, analysis based on shapes and interactions derived from them would be a novel methodology for the social behavior literature in neuroscience, which has been largely focused on trajectory based features or image histogram based features. In terms of the methodological advances we have made, I would also argue that there is very little lost. Everything we have done so far has been for the improvement of tracking body part markers, and I am reaching a point where I believe there will be an asymptote to the performance gains to be made from just examining the markers alone. This conclusion is based on my own experience, as well as talking to others who have worked with multi-animal DLC, DPK, and other pose tracking variants (such as when considering the frames that we looked at today). Accurate tracked positions as generated by our anomaly detection techniques will play a fundamental role in recovering body contours in each frame of behavioral video, and by estimating a good joint model of fourier descriptors and body markers, we will be able to reciprocally improve our detection of body part markers using morphological constraints that respect the image data, should we need to localize other body parts for a future application. Furthermore, I expect we will still need techniques like segment matching through branch and bound or TV norm optimization to refine the identities assigned to fourier descriptors, but I also imagine that it will be an easier task to apply these techniques to body contours than to isolated points. If nothing else, I think that fourier descriptors for body boundary resolution will serve as a useful additional set of constraints to refine our tracked markers.